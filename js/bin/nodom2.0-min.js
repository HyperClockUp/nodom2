"use strict";Object.prototype.clone||(Object.prototype.clone=function(e){let t=new WeakMap,r=function r(o){let n;return nodom.isObject(o)?(n=new Object,t.set(o,n),Object.getOwnPropertyNames(o).forEach(i=>{if(!e||!(e.constructor===RegExp&&e.test(i)||e.constructor===String&&e===i))if(nodom.isObject(o[i])||nodom.isArray(o[i])){let e=null;t.has(o[i])?e=t.get(o[i]):(e=r(o[i]),t.set(o[i],e)),n[i]=e}else n[i]=o[i]})):nodom.isArray(o)&&(n=new Array,t.set(o,n),o.forEach(function(e,t){nodom.isObject(e)||nodom.isArray(e)?n[t]=r(e):n[t]=e})),n}(this);return t=null,r});class nodom{static genId(){return void 0===this.generatedId&&(this.generatedId=1),this.generatedId++}static merge(){for(let e=0;e<arguments.length;e++)if(!nodom.isObject(arguments[e]))throw Error.handle("invoke","nodom.merge",e,"object");let e=Object.assign.apply(null,arguments);return function(e){for(let t in e)(nodom.isObject(e[t])||nodom.isArray(e[t]))&&(e[t]=e[t].clone())}(e),e}static assign(e,t){return Object.assign?Object.assign(e,t):nodom.getOwnProps(t).forEach(function(r){e[r]=t[r]}),e}static getOwnProps(e){return e?Object.getOwnPropertyNames(e):[]}static isFunction(e){return void 0!==e&&null!==e&&e.constructor===Function}static isArray(e){return Array.isArray(e)}static isObject(e){return null!==e&&void 0!==e&&e.constructor===Object}static isInt(e){return Number.isInteger(e)}static isNumber(e){return"number"==typeof e}static isBoolean(e){return"boolean"==typeof e}static isString(e){return"string"==typeof e}static isNumberString(e){return/^\d+\.?\d*$/.test(e)}static isEmpty(e){if(null===e||void 0===e)return!0;let t=typeof e;if(nodom.isObject(e)){let t=Object.keys(e);if(void 0!==t)return 0===t.length}else if("string"===t)return""===e;return!1}static findObjByProps(e,t,r){if(!nodom.isObject(e))throw Error.handle("invoke","nodom.findObjByProps",0,"Object");r=r||!1;let o=nodom.getOwnProps(t),n=!1;if(!1===r){n=!0;for(let r=0;r<o.length;r++){let i=o[r];if(e[i]!==t[i]){n=!1;break}}}else for(let r=0;r<o.length;r++){let i=o[r];if(e[i]===t[i]){console.log(i),n=!0;break}}if(n)return e;for(let o in e){let n=e[o];if(null!==n)if(nodom.isObject(n)){let e=nodom.getOwnProps(n);for(let o=0;o<e.length;o++){let n=e[o];if(null!==n&&nodom.isObject(n)){let e=nodom.findObjByProps(n,t,r);if(null!==e)return e}}}else if(nodom.isArray(n))for(let e=0;e<n.length;e++){let o=n[e];if(null!==o&&nodom.isObject(o)){let e=nodom.findObjByProps(o,t,r);if(null!==e)return e}}}return null}static get(e,t,r){return r=r||document,!0===t?r.querySelectorAll(e):r.querySelector(e)}static append(e,t){if(nodom.isNode(t))e.appendChild(t);else if(nodom.isString(t)){let r=nodom.newEl("div");r.innerHTML=t,nodom.transChildren(r,e)}}static isEl(e){return e instanceof HTMLElement}static isNode(e){return void 0!==e&&null!==e&&(e.nodeType===Node.TEXT_NODE||e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)}static getTranslate(e){let t,r=e.style.transform;if(r&&"none"!==r){t=[];let e=r.substring(r.indexOf("(")+1,r.indexOf(")")-1);e=e.split(",");for(let r=0;r<e.length;r++)t.push(parseInt(e[r]))}return t||[0,0,0]}static newEl(e,t,r){if(!nodom.isString(e)||nodom.isEmpty(e))throw Error.handle("invoke","nodom.newEl",0,"string");let o=document.createElement(e);return nodom.isObject(t)?nodom.attr(o,t):nodom.isString(r)&&(o.innerHTML=r),o}static newSvgEl(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}static replaceNode(e,t,r){if(!nodom.isNode(e))throw Error.handle("invoke","nodom.replaceNode",0,"Node");if(!nodom.isNode(t)&&!nodom.isArray(t))throw Error.handle("invoke1","nodom.replaceNode",1,"Node","Node Array");r=r||!1;let o=e.parentNode,n=e.nextSibling;null!==o&&(o.removeChild(e),nodom.isArray(t)||(t=[t]),t.forEach(function(t){void 0===n||null===n?o.appendChild(t):o.insertBefore(t,n),!1!==r&&(r=!0),r&&e.$isView&&nodom.copyProp(t,e)}))}static insertAfter(e,t,r){const o=this;if(!nodom.isNode(e))throw Error.handle("invoke","nodom.insertAfter",0,"Node");if(!nodom.isNode(t)&&!nodom.isNode(r))throw Error.handle("invoke2","nodom.insertAfter",1,2,"Node");let n=null;void 0===t||null===t?n=r.firstChild:(r=t.parentNode,n=t.nextSibling),nodom.isNode(r)&&(null===n?nodom.isArray(e)?e.forEach(function(e){o.isEl(e)&&r.appendChild(e)}):r.appendChild(e):nodom.isArray(e)?e.forEach(function(e){o.isEl(e)&&r.insertBefore(e,n)}):r.insertBefore(e,n))}static empty(e){if(!this.isEl(e))throw Error.handle("invoke","nodom.empty",0,"Element");let t=e.childNodes;for(let r=t.length-1;r>=0;r--)e.removeChild(t[r])}static remove(e){if(!this.isNode(e))throw Error.handle("invoke","nodom.remove",0,"Node");null!==e.parentNode&&e.parentNode.removeChild(e)}static attr(e,t,r){if(!this.isEl(e))throw Error.handle("invoke","nodom.attr",0,"Element");if(nodom.isEmpty(t))throw Error.handle("invoke","nodom.attr",1,"string","object");if(void 0===r||null===r){if(nodom.isObject(t))nodom.getOwnProps(t).forEach(function(r){"value"===r?e[r]=t[r]:e.setAttribute(r,t[r])});else if(nodom.isString(t))return"value"===t?t.value:e.getAttribute(t)}else"value"===t?e[t]=r:e.setAttribute(t,r)}static width(e,t){if(!nodom.isEl(e))throw Error.handle("invoke","nodom.width",0,"Element");if(!nodom.isNumber(t)){let r;if(window.getComputedStyle&&(r=window.getComputedStyle(e,null)),!r)return null;let o=parseInt(r.width);if(!0===t){o-=parseInt(r["panodom.ngLeft"])+parseInt(r["panodom.ngRight"])}return o}e.style.width=t+"px"}static height(e,t){if(!nodom.isEl(e))throw Error.handle("invoke","nodom.height",0,"Element");if(!nodom.isNumber(t)){let r;if(window.getComputedStyle&&(r=window.getComputedStyle(e,null)),!r)return null;let o=parseInt(r.height);if(!0===t){o-=parseInt(r["panodom.ngTop"])+parseInt(r["panodom.ngBotto,"])}return o}e.style.height=t+"px"}static addClass(e,t){if(!nodom.isEl(e))throw Error.handle("invoke","nodom.addClass",0,"Element");if(nodom.isEmpty(t))throw Error.handle("invoke","nodom.addClass",1,"string");let r=e.className.trim();if(nodom.isEmpty(r))e.className=t;else{let o=r.split(/\s+/);for(let e=0;e<o.length;e++)if(o[e]===t)return;o.push(t),e.className=o.join(" ")}}static removeClass(e,t){if(!nodom.isEl(e))throw Error.handle("invoke","nodom.removeClass",0,"Element");if(nodom.isEmpty(t))throw Error.handle("invoke","nodom.removeClass",1,"string");let r=e.className.trim();if(!nodom.isEmpty(r)){let o=r.split(/\s+/);for(let r=0;r<o.length;r++)if(o[r]===t)return o.splice(r,1),void(e.className=o.join(" "))}}static formatDate(e,t){if(nodom.isString(e)){if(null!==new RegExp(/^\d+$/).exec(e))try{e=parseInt(e)}catch(e){}}if(e=new Date(e),isNaN(e.getDay()))return"";let r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours()%12==0?12:e.getHours()%12,"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},o={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};return/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),nodom.getOwnProps(r).forEach(function(e){new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[e]:("00"+r[e]).substr((""+r[e]).length)))}),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+o[e.getDay()+""])),t}static toDate(e){let t;try{t=new Date(Date.parse(e))}catch(e){}if(!t)throw Error.handle("invoke","nodom.toDate",0,"date string");return(isNaN(t)||isNaN(t.getDay()))&&(14===e.length?(e=e.substr(0,4)+"/"+e.substr(4,2)+"/"+e.substr(6,2)+" "+e.substr(8,2)+":"+e.substr(10,2)+":"+e.substr(12),t=new Date(Date.parse(e))):8===e.length&&(e=e.substr(0,4)+"/"+e.substr(4,2)+"/"+e.substr(6,2),t=new Date(Date.parse(e)))),t}static compileStr(){let e,t=new RegExp(/\{.+?\}/),r=arguments,o=r[0];for(;null!==(e=t.exec(o));){let n,i=e[0].substr(1,e[0].length-2),s=parseInt(i)+1;n=void 0!==r[s]?r[s]:"",o=o.replace(t,n)}return o}static addStrQuot(e,t){return e=(e=(e=e.replace(/\'/g,"\\'")).replace(/\"/g,'\\"')).replace(/\`/g,"\\`"),e=(t=t||'"')+e+t}static apply(e,t,r){return Reflect.apply(e,t,r)}}nodom.config={renderTick:50,appPath:"/page/",deviceType:"ontouchend"in document?1:2,routerPrePath:"/route"};class Class{static add(e,t){this.items.set(e,t)}static getClass(e){return this.items.get(e)}static newInstance(e,t){let r=this.items.get(e);return void 0===r?null:Reflect.construct(r,t||[])}static getClassName(e){if(e.constructor)return e.constructor.name}}Class.items=new Map;class Linker{constructor(e,t){const r=this;let o;switch(e){case"ajax":o=r.ajax(t);break;case"getfiles":o=r.getfiles(t);break;case"dolist":o=3===arguments.length?r.dolist(arguments[1],0,arguments[2]):r.dolist(arguments[1],0)}return o}ajax(e){return new Promise((t,r)=>{e.rand&&(e.params=e.params||{},e.params.$rand=Math.random());const o=e.url,n=!1!==e.async,i=new XMLHttpRequest;i.withCredentials=e.withCredentials;const s=e.reqType||"GET";switch(i.timeout=n?e.timeout:0,i.onload=(()=>{if(200===i.status){let o=i.responseText;if("json"===e.type)try{o=JSON.parse(o)}catch(e){r({type:"jsonparse"})}t(o)}else r({type:"error",url:o})}),i.ontimeout=(()=>r({type:"timeout"})),i.onerror=(()=>r({type:"error",url:o})),s){case"GET":let a;if(nodom.isObject(e.params)){let t=[];nodom.getOwnProps(e.params).forEach(function(r){t.push(r+"="+e.params[r])}),a=t.join("&")}void 0!==a&&(-1!==o.indexOf("?")?o+="&"+a:o+="?"+a),i.open(s,o,n,e.user,e.pwd),i.send(null);break;case"POST":let l=new FormData;for(let t in e.params)l.append(t,e.params[t]);i.open(s,o,n,e.user,e.pwd),i.send(l)}}).catch(e=>{switch(e.type){case"error":throw Error.handle("notexist1",nodom.words.resource,e.url);case"timeout":throw Error.handle("timeout");case"jsonparse":throw Error.handle("jsonparse")}})}getfiles(e){let t=[];return e.forEach(e=>{t.push(new Promise((t,r)=>{const o=new XMLHttpRequest;o.onload=(()=>t(o.responseText)),o.onerror=(()=>r(e)),o.open("GET",e),o.send()}))}),Promise.all(t).catch(e=>{throw Error.handle("notexist1",nodom.words.resource,e)})}dolist(e,t,r){return function e(t,r,o){return 0===t.length?Promise.resolve():new Promise((e,n)=>{null!==o||void 0!==o?t[r](e,n,o[r]):t[r](e,n)}).then(n=>{if(r<t.length-1)return e(t,r+1,o)})}(e,t,r)}}class Factory{constructor(e){void 0!==e&&(this.moduleName=e.name),this.items=Object.create(null)}add(e,t){this.items[e]=t}get(e){return this.items[e]}remove(e){delete this.items[e]}}class MessageFactory{static add(e,t,r){this.messages.push({from:e,to:t,msg:r,read:!1})}static broadcast(){for(let e=0;e<MessageFactory.messages.length;e++){let t=MessageFactory.messages[e],r=ModuleFactory.get(t.to);(r&&2===r.state||3===r.state)&&r.receive(t.from,t.msg),r&&r.state>=2&&MessageFactory.messages.splice(e--,1)}}}MessageFactory.messages=new Array;class ModuleFactory{static add(e,t){this.items.set(e,t)}static get(e){return this.items.get(e)}static remove(e){this.items.delete(e)}static setMain(e){this.mainModule=e}static getMain(){return this.mainModule}}ModuleFactory.items=new Map,ModuleFactory.mainModule=void 0;class ExpressionFactory extends Factory{}class DirectiveFactory extends Factory{}class Compiler{static compile(e){return compileEl(e)}static compile(e,t){let r=new Element;const o=nodom.newEl("div");return o.innerHTML=t,r.isRoot=!0,this.compileDom(e,o,r),r}static compileDom(e,t,r){const o=this;let n=new Element,i=(n.props,!1);switch(t.nodeType){case Node.ELEMENT_NODE:n.tagName=t.tagName;for(let r=0;r<t.attributes.length;r++){let i=t.attributes[r],s=i.value.trim();if(i.name.startsWith("x-"))n.directives.push(new Directive(i.name.substr(2),s,n,e,t));else if(i.name.startsWith("e-")){let e=i.name.substr(2);n.events[e]=new Event(e,i.value.trim())}else{let t=!1;if(""!==s){let r=o.compileExpression(e,s);nodom.isArray(r)&&(n.exprProps[i.name]=r,t=!0)}t||(n.props[i.name]=s)}}let r=[];t.childNodes.forEach(function(t){r.push(o.compileDom(e,t,n))}),n.directives.sort((e,t)=>DirectiveManager.getType(e.type).prio-DirectiveManager.getType(t.type).prio);break;case Node.TEXT_NODE:let s=t.textContent;if(""===s)return;let a=o.compileExpression(e,s);"string"==typeof a?n.textContent=a:n.expressions=a;break;case Node.COMMENT_NODE:i=!0}return!i&&r&&r.children.push(n),n}static compileExpression(e,t){if(!1===new RegExp("{{.+?}}","g").test(t))return t;let r,o=new Array,n=t.matchAll(/\{\{.+?\}\}/g),i=0;for(r of n){let n=r.index;if(n>i){let e=t.substring(i,n);o.push(e)}let s=new Expression(r[0].substring(2,r[0].length-2),e);e.expressionFactory.add(s.id,s),o.push(s.id),i=n+r[0].length}return r&&r.index+r[0].length<t.length-1&&o.push(t.substr(r.index+r[0].length)),o}}class Renderer{static add(e){const t=this;3===e.state&&-1===t.waitList.indexOf(e.name)&&t.waitList.push(e.name)}static remove(e){let t;-1!==(t=me.waitList.indexOf(e.name))&&me.waitList.splice(t,1)}static render(){for(let e=0;e<Renderer.waitList.length;e++){let t=ModuleFactory.get(Renderer.waitList[e]);t&&!t.render()||Renderer.waitList.splice(e--,1)}}}Renderer.waitList=[];class Scheduler{static dispatch(){Scheduler.tasks.forEach(e=>{nodom.isFunction(e)&&e()})}static start(){Scheduler.dispatch(),window.requestAnimationFrame?window.requestAnimationFrame(Scheduler.start):window.setTimeout(Scheduler.start,nodom.config.renderTick)}static addTask(e){if(!nodom.isFunction(e))throw Error.handle("invoke","Scheduler.addTask","0","function");void 0!==Scheduler.tasks.indexOf(e)&&Scheduler.tasks.push(e)}static removeTask(e){if(!nodom.isFunction(e))throw Error.handle("invoke","Scheduler.removeTask","0","function");let t=-1;-1!==(t=Scheduler.tasks.indexOf(e))&&Scheduler.tasks.splice(t,1)}}Scheduler.tasks=[],Scheduler.addTask(MessageFactory.broadcast),Scheduler.addTask(Renderer.render),Scheduler.start();class Expression{constructor(e,t){const r=this;r.fields=[],r.modelMap={},r.id=nodom.genId(),t&&(r.moduleName=t.name,t.expressionFactory.add(r.id,r)),e&&(r.stack=this.init(e))}init(e){const t=this;let r=void 0,o=0,n="()!|*/+-><=&%",i=new Array,s="";for(let a=0;a<e.length;a++){let l=e[a];if(1!==o&&-1!==" \t".indexOf(l))continue;switch(o){case 1:if(-1!=="'`\"".indexOf(l)&&l===r){t.addStr(s+l,i),r=void 0,s="",o=0;continue}break;case 2:-1!==n.indexOf(l)&&("("===l?o=3:(t.addVar(s,i),s="",o=0));break;case 3:if(")"===l){let e=s.trim().split("("),r=e[0],n=e[1].split(",");for(let e=0;e<n.length;e++){let r=n[e].trim();n[e]=r,t.addField(r)}i.push({val:r,params:n,type:"function"}),s="",o=0;continue}break;default:-1!=="'`\"".indexOf(l)?(r=l,o=1):-1===n.indexOf(l)&&(o=2,""!==s&&(t.addStr(s,i),s=""))}let d=!1;if("|"===l){let r=a+1,o=e[r];if(o>="a"&&o<="z"){let t="";for(;r<e.length;r++){let o=e[r];if(-1!=="'`\"".indexOf(o)&&(t=o===t?"":o),""===t&&-1!==n.indexOf(o))break}}if(r>a){let o=e.substring(a+1,r);if(""!==o){let r=FilterManager.explain(o);FilterManager.hasType(r[0])&&(t.addFilter(r,i),l="",e="",d=!0)}}}d||1===o||3===o||-1===n.indexOf(l)?s+=l:t.addOperand(l,i)}if(2===o)t.addVar(s,i);else if(0===o&&""!==s)t.addStr(s,i);else if(0!==o)throw Error.handle("invoke","expression",0,"Node");return i}val(e,t){const r=this;if(!e)return"";if(null===r.stack)return"";let o;e instanceof Model?(t=e.id,o=Object.create(null),r.fields.forEach(t=>{o[t]=r.getFieldValue(e,t)})):o=e;let n="";return r.fields.forEach(e=>{n+=o[e]}),void 0===r.modelMap[t]&&(r.modelMap[t]=Object.create(null)),r.modelMap[t].fieldValue!==n&&(r.modelMap[t].value=r.cacStack(r.stack,o,t)),r.modelMap[t].fieldValue=n,r.modelMap[t].value}addVar(e,t){const r=this;let o=-1!==["null","undefined","true","false","NaN"].indexOf(e);(o=o||nodom.isNumberString(e))?this.addStr(e,t):(t.push({val:e.trim(),type:"field"}),r.addField(e))}addStr(e,t){t.length>0&&"string"===t[t.length-1].type?t[t.length-1].val+=e:t.push({val:e,type:"string"})}addOperand(e,t){t.push({val:e,type:"operand"})}addFilter(e,t){const r=this;let o=ModuleFactory.get(r.moduleName);if(t.length>0){let n=[],i=t[t.length-1],s=i.type;if("field"===s||"function"===s||"string"===s)n.push(t.pop());else if("operand"===s&&")"===i.val){let e=1,r=t.length-2;for(;r>=0;r--)if("("===t[r].val){if(0==--e)break}else")"===t[r].val&&e++;n=t.slice(r,t.length),t.splice(r,t.length-r)}let a=new Expression(null,o);a.stack=n,a.fields=r.fields,r.pre||(r.pre=[]),r.pre.push(a.id),t.push({type:"filter",filter:new Filter(e),val:a.id})}}cacStack(stack,fieldObj,modelId){const me=this;let retStr="",needEval=!1,module=ModuleFactory.get(me.moduleName);if(stack.forEach(e=>{let t="";switch(e.type){case"string":retStr+=e.val;break;case"operand":retStr+=e.val,needEval=!0;break;case"field":t=fieldObj[e.val],nodom.isString(t)&&""!==t&&(t=nodom.addStrQuot(t)),retStr+=t;break;case"function":let r=module.methodFactory.get(e.val),o=[];e.params.length>0&&e.params.forEach(e=>{let t=fieldObj[e];nodom.isString(t)&&""!==t&&(t=nodom.addStrQuot(t)),o.push(t)}),void 0!==r&&nodom.isFunction(r)?t=r.apply(module.model,o):(t=e.val+"("+o.join(",")+")",needEval=!0),retStr+=t;break;case"filter":t=module.expressionFactory.get(e.val).val(fieldObj,modelId),"object"==typeof(t=e.filter.exec(t,module))?retStr=t:(nodom.isString(t)&&""!==t&&(t=nodom.addStrQuot(t)),retStr+=t)}}),needEval)try{retStr=eval(retStr)}catch(e){}else nodom.isString(retStr)&&'"'===retStr.charAt(0)&&(retStr=retStr.substring(1,retStr.length-1));return retStr}addField(e){const t=this;-1===t.fields.indexOf(e)&&t.fields.push(e)}getFieldValue(e,t){let r=ModuleFactory.get(this.moduleName);if(!e&&r&&(e=r.model),!e)return"";let o=e.query(t);return void 0===o&&e!==r.model&&(o=r.model.query(t)),void 0===o?"":o}}class Element{constructor(e){const t=this;t.directives=[],t.props={},t.events={},t.exprProps={},t.changeProps=[],t.removeProps=[],t.children=[],t.parentKey=void 0,t.tagName=e||void 0,t.dontRender=!1,t.key=nodom.genId()}render(e,t){const r=this;if(t&&(r.parentKey=t.key,r.modelId||(r.modelId=t.modelId)),void 0!==r.tagName?(r.handleProps(e),r.handleDirectives(e,t)):r.handleTextContent(e),!r.dontRender)for(let t=0;t<r.children.length;t++){let o=r.children[t];o.render(e,r),o.dontRender&&(r.removeChild(o),t--)}return!0}renderToHtml(e,t){const r=this;let o,n,i=t.type,s=t.parent;e.modelFactory;if(s?"fresh"===i||"add"===i||"text"===i?o=e.container.querySelector("[key='"+s.key+"']"):void 0!==r.tagName&&(o=e.container.querySelector("[key='"+r.key+"']")):o=e.container,o)switch(i){case"fresh":r.tagName?d(n=a(r,null,o),r):n=l(r.textContent,r),o.appendChild(n);break;case"text":if(!s||!s.children)break;let e=s.children.indexOf(r);if(-1!==e){let t=document.querySelector("[key='"+r.key+"']");"html"===r.type?null!==t?(t.innerHTML="",t.appendChild(r.textContent)):(t=l(r.textContent),nodom.replaceNode(o.childNodes[e],t)):o.childNodes[e].textContent=r.textContent}break;case"upd":t.removeProps&&t.removeProps.forEach(e=>{o.removeAttribute(e)}),t.changeProps.forEach(e=>{"INPUT"===o.tagName&&"value"===e.p?o.value=e.v:o.setAttribute(e.p,e.v)});break;case"rep":n=a(r,s),nodom.replaceNode(o,n);break;case"add":r.tagName?d(n=a(r,s,o),r):n=l(r.textContent),t.index===o.childNodes.length?o.appendChild(n):o.insertBefore(n,o.childNodes[t.index])}function a(t,r,o){let n=document.createElement(t.tagName);return nodom.getOwnProps(t.props).forEach(e=>{n.setAttribute(e,t.props[e])}),n.setAttribute("key",t.key),t.handleEvents(e,n,r,o),n}function l(e,t){if(t&&"html"===t.type){let r=nodom.newEl("div");return r.setAttribute("key",t.key),r.appendChild(e),r}return document.createTextNode(e)}function d(e,t){t.children&&t.children.length>0&&t.children.forEach(r=>{let o;r.tagName?d(o=a(r,t,e),r):o=l(r.textContent,r),e.appendChild(o)})}}clone(){const e=this;let t=new Element;return nodom.getOwnProps(e).forEach(r=>{"object"!=typeof e[r]&&(t[r]=e[r])}),e.directives.forEach(e=>{t.directives.push(e)}),nodom.getOwnProps(e.props).forEach(r=>{t.props[r]=e.props[r]}),nodom.getOwnProps(e.exprProps).forEach(r=>{t.exprProps[r]=e.exprProps[r]}),nodom.getOwnProps(e.events).forEach(r=>{t.events[r]=e.events[r].clone()}),t.expressions=e.expressions,e.children.forEach(e=>{t.children.push(e.clone())}),t}handleDirectives(e,t){const r=this;if(r.dontRender)return!1;const o=r.directives;for(let n=0;n<o.length&&!r.dontRender;n++)DirectiveManager.exec(o[n],r,e,t);return!0}handleExpression(e,t){const r=this;if(r.dontRender)return;let o="",n=t.modelFactory.get(r.modelId);return e.forEach(e=>{if("number"==typeof e){let i=t.expressionFactory.get(e).val(n);if(i instanceof DocumentFragment||nodom.isEl(i))return r.type="html",i;o+=i}else o+=e}),o}handleProps(e){const t=this;t.dontRender||nodom.getOwnProps(t.exprProps).forEach(r=>{nodom.isArray(t.exprProps[r])?t.props[r]=t.handleExpression(t.exprProps[r],e):t.exprProps[r]instanceof Expression&&(t.props[r]=t.exprProps[r].val(e.modelFactory.get(t.modelId)))})}handleTextContent(e){const t=this;t.dontRender||void 0!==t.expressions&&(t.textContent=t.handleExpression(t.expressions,e))}handleEvents(e,t,r,o){const n=this;0!==n.events.length&&nodom.getOwnProps(n.events).forEach(i=>{let s=n.events[i];s.delg&&r?s.delegateTo(e,n,t,r,o):s.bind(e,n,t)})}removeDirectives(e){const t=this;for(let r=t.directives.length-1;r>=0;r--){let o=t.directives[r];for(let n=0;n<e.length;n++)o.type===e[n]&&t.directives.splice(r,1)}}hasDirective(e){const t=this;for(let r=0;r<t.directives.length;r++)if(t.directives[r].type===e)return!0;return!1}getDirective(e){const t=this;for(let r=0;r<t.directives.length;r++)if(t.directives[r].type===e)return t.directives[r]}add(e){me.children.push(e)}remove(e,t){const r=this;if(void 0!==r.parentKey){let t=e.renderTree.query(r.parentKey);t&&t.removeChild(r)}if(t&&e&&e.container){let t=e.container.querySelector("[key='"+r.key+"']");null!==t&&nodom.remove(t)}r.free()}removeFromHtml(e){let t=e.container.querySelector("[key='"+this.key+"']");null!==t&&nodom.remove(t)}removeChild(e){const t=this;let r=-1;nodom.isArray(t.children)&&-1!==(r=t.children.indexOf(e))&&t.children.splice(r,1)}replace(e){if(!e.parent)return!1;let t=e.parent.children.indexOf(e);return-1!==t&&(e.parent.children.splice(t,1,this),!0)}contains(e){const t=this;for(;void 0!==e&&e!==t;e=e.parent);return void 0!==e}query(e){const t=this;if(t.key===e)return t;for(let r=0;r<t.children.length;r++){let o=t.children[r].query(e);if(o)return o}}queryProp(e,t){const r=this;if(r.key===key)return r;for(let e=0;e<r.children.length;e++){let t=r.children[e].query(key);if(t)return t}}compare(e,t,r){if(!e)return;const o=this;let n=Object.create(null),i=!1;void 0===o.tagName?void 0===e.tagName?o.textContent!==e.textContent&&(n.type="text",i=!0):(n.type="rep",i=!0):o.tagName!==e.tagName?(n.type="rep",i=!0):(n.changeProps=[],n.removeProps=[],nodom.getOwnProps(e.props).forEach(e=>{o.props.hasOwnProperty(e)||n.removeProps.push(e)}),nodom.getOwnProps(o.props).forEach(t=>{o.props[t]!==e.props[t]&&n.changeProps.push({p:t,v:o.props[t]})}),(n.changeProps.length>0||n.removeProps.length>0)&&(i=!0,n.type="upd")),i&&(n.node=o,r&&(n.parent=r),t.push(n)),o.children&&0!==o.children.length?e.children&&0!==e.children.length?(o.children.forEach((r,n)=>{let i=e.children[n];if(!i||r.key!==i.key){i=void 0;for(let t=0;t<e.children.length;t++)if(r.key===e.children[t].key){i=e.children[t];break}}void 0!==i?(r.compare(i,t,o),i.finded=!0):t.push({type:"add",node:r,parent:o,index:n})}),e.children&&e.children.length>0&&e.children.forEach(r=>{r.finded||t.push({type:"del",node:r,parent:e})})):o.children.forEach(e=>{t.push({type:"add",node:e,parent:o})}):e.children&&e.children.length>0&&e.children.forEach(e=>{t.push({type:"del",node:e})})}}class Event{constructor(e,t){const r=this;if(r.events=void 0,r.name=e,t&&t.split(":").forEach((e,t)=>{e=e.trim(),0===t?r.handler=e:r[e]=!0}),1===nodom.config.deviceType)switch(r.name){case"click":r.name="tap";break;case"mousedown":r.name="touchstart";break;case"mouseup":r.name="touchend";break;case"mousemove":r.name="touchmove"}else switch(r.name){case"tap":r.name="click";break;case"touchstart":r.name="mousedown";break;case"touchend":r.name="mouseup";break;case"touchmove":r.name="mousemove"}}fire(e){const t=this,r=ModuleFactory.get(t.moduleName),o=r.renderTree.query(t.domKey),n=r.container.querySelector("[key='"+t.domKey+"']"),i=r.modelFactory.get(o.modelId);function s(e,r,o,n){if(void 0===t.events)return!0;let i=t.events[t.name];if(nodom.isArray(i))if(i.length>0){for(let r=0;r<i.length;r++)if(i[r].el&&i[r].el.contains(e.target)&&(i[r].fire(e),i[r].once&&t.removeSubEvt(i[r]),i[r].nopopo))return!1}else t.events.delete(t.name);return!0}function a(e,r,n,i){let s=n.methodFactory.get(t.handler);nodom.isFunction(s)&&(t.nopopo&&e.stopPropagation(),nodom.apply(s,r,[e,n,i,o]),t.once&&delete t.handler)}t.capture?(a(e,i,r,n),s(e,i,r,n)):s(e,i,r,n)&&a(e,i,r,n),void 0!==t.events&&0===t.events[t.name].length&&void 0===t.handler&&(ExternalEvent.TouchEvents[t.name]?ExternalEvent.unregist(t,n):null!==n&&n.removeEventListener(t.name,t.handleEvent))}bind(e,t,r){const o=this;o.domKey=t.key,o.moduleName=e.name,ExternalEvent.TouchEvents[o.name]?ExternalEvent.regist(o,r,e,t):(o.handleEvent=function(e){o.fire(e)},r.addEventListener(o.name,o.handleEvent,o.capture))}delegateTo(e,t,r,o,n){const i=this;if(i.domKey=t.key,i.moduleName=e.name,n||(n=document.body),!o.events[i.name]){let t=new Event(i.name);t.bind(e,o,n),o.events[i.name]=t}o.events[i.name].addSubEvt(i)}addSubEvt(e){const t=this;t.events||(t.events=Object.create(null)),t.events[t.name]||(t.events[t.name]=new Array),t.events[t.name].push(e)}removeSubEvt(e){const t=this;if(void 0===t.events||void 0===t.events[e.name])return;let r=t.events[e.name].indexOf(e);-1!==r&&(t.events[e.name].splice(r,1),0===t.events[e.name].length&&t.events.delete(e.name))}clone(){const e=this;let t=new Event(e.name);return["delg","once","nopopo","useCapture","handler","handleEvent","module"].forEach(r=>{t[r]=e[r]}),t}}class ExternalEvent{static regist(e,t){let r=ExternalEvent.TouchEvents[e.name];if(nodom.isEmpty(e.touchListeners)||ExternalEvent.unregist(e),!t){const r=ModuleFactory.get(e.moduleName);t=r.container.querySelector("[key='"+e.domKey+"']")}e.touchListeners={},r&&null!==t&&nodom.getOwnProps(r).forEach(function(o){e.touchListeners[o]=function(t){r[o](t,e)},t.addEventListener(o,e.touchListeners[o],e.capture)})}static unregist(e,t){let r=nodom.Event.TouchEvents[e.eventName];if(!t){const r=ModuleFactory.get(e.moduleName);t=r.container.querySelector("[key='"+e.domKey+"']")}r&&null!==t&&nodom.getOwnProps(e.touchListeners).forEach(function(r){t.removeEventListener(r,e.touchListeners[r])})}}ExternalEvent.TouchEvents={tap:{touchstart:function(e,t){let r=e.touches[0];t.extParams={pos:{sx:r.pageX,sy:r.pageY,t:Date.now()}}},touchmove:function(e,t){let r=t.extParams.pos,o=e.touches[0],n=o.pageX-r.sx,i=o.pageY-r.sy;(Math.abs(n)>5||Math.abs(i)>5)&&(r.move=!0)},touchend:function(e,t){let r=t.extParams.pos,o=Date.now()-r.t;!0===r.move||o>200||t.fire(e)}},swipe:{touchstart:function(e,t){let r=e.touches[0],o=Date.now();t.extParams={swipe:{oldTime:[o,o],speedLoc:[{x:r.pageX,y:r.pageY},{x:r.pageX,y:r.pageY}],oldLoc:{x:r.pageX,y:r.pageY}}}},touchmove:function(e,t){let r=Date.now(),o=e.touches[0],n=t.extParams.swipe;r-n.oldTime>50&&(n.speedLoc[0]={x:n.speedLoc[1].x,y:n.speedLoc[1].y},n.speedLoc[1]={x:o.pageX,y:o.pageY},n.oldTime[0]=n.oldTime[1],n.oldTime[1]=r),n.oldLoc={x:o.pageX,y:o.pageY}},touchend:function(e,t){let r=t.extParams.swipe,o=Date.now(),n=o-r.oldTime[1]<30?0:1,i=r.oldLoc.x-r.speedLoc[n].x,s=r.oldLoc.y-r.speedLoc[n].y,a=Math.sqrt(i*i+s*s),l=o-r.oldTime[n];if(l>300||a<10)return;let d=a/l;if(d>.05){let r="";i<0&&Math.abs(s/i)<1&&(e.v0=d,r="swipeleft"),i>0&&Math.abs(s/i)<1&&(e.v0=d,r="swiperight"),s>0&&Math.abs(i/s)<1&&(e.v0=d,r="swipedown"),s<0&&Math.abs(i/s)<1&&(e.v0=d,r="swipeup"),t.name===r&&t.fire(e)}}}},ExternalEvent.TouchEvents.swipeleft=ExternalEvent.TouchEvents.swipe,ExternalEvent.TouchEvents.swiperight=ExternalEvent.TouchEvents.swipe,ExternalEvent.TouchEvents.swipeup=ExternalEvent.TouchEvents.swipe,ExternalEvent.TouchEvents.swipedown=ExternalEvent.TouchEvents.swipe,nodom.words={system:"系统",module:"模块",moduleClass:"模块类",model:"模型",directive:"指令",expression:"表达式",event:"事件",method:"方法",filter:"过滤器",filterType:"过滤器类型",data:"数据",dataItem:"数据项",route:"路由",routeView:"路由容器",plugin:"插件",resource:"资源",method:"方法"},nodom.ErrorMsgs={unknown:"未知错误",paramException:"{0}'{1}'方法参数错误，请参考api",invoke:"{0}方法调用参数{1}必须为{2}",invoke1:"{0}方法调用参数{1}必须为{2}或{3}",invoke2:"{0}方法调用参数{1}或{2}必须为{3}",invoke3:"{0}方法调用参数{1}不能为空",exist:"{0}已存在",exist1:"{0}'{1}'已存在",notexist:"{0}不存在",notexist1:"{0}'{1}'不存在",notupd:"{0}不可修改",notremove:"{0}不可删除",notremove1:"{0}{1}不可删除",namedinvalid:"{0}{1}命名错误，请参考用户手册对应命名规范",initial:"{0}初始化参数错误",jsonparse:"JSON解析错误",timeout:"请求超时"},nodom.FormMsgs={type:"请输入有效的{0}",unknown:"输入错误",required:"不能为空",min:"最小输入值为{0}",max:"最大输入值为{0}"};class Error{static handle(e){new RegExp(/\{.+?\}/);var t=nodom.ErrorMsgs[e];if(void 0===t)return"未知错误";for(var r=[t],o=1;o<arguments.length;o++)r.push(arguments[o]);return nodom.compileStr.apply(null,r)}}class ModelFactory extends Factory{}class Model{constructor(e,t){const r=this;r.data=e,r.fields={},r.id=nodom.genId(),t&&(r.moduleName=t.name,t.modelFactory&&t.modelFactory.add(r.id,r)),e.$modelId=r.id,r.addSetterGetter(e,t)}set(e,t){const r=this;let o,n,i=e.lastIndexOf(".");if(-1!==i?(o=e.substr(i+1),e=e.substr(0,i),n=r.query(e)):(o=e,n=r.data),void 0===n)throw Error.handle("notexist1",nodom.words.dataItem,e);if(n[o]!==t){let e=ModuleFactory.get(r.moduleName);(nodom.isObject(t)||nodom.isArray(t))&&new Model(t,e);let i=e.modelFactory.get(n.$modelId);i&&(void 0===n[o]&&r.defineProp(n,o),i.update(o,t)),n[o]=t}}update(e,t){const r=this;let o=!1;nodom.isString(e)&&r.fields[e]!==t&&(r.fields[e]=t,o=!0),o&&ModuleFactory.get(r.moduleName).dataChange(r)}addSetterGetter(e){const t=this;if(nodom.isObject(e))nodom.getOwnProps(e).forEach(function(r){let o=e[r];nodom.isObject(o)||nodom.isArray(o)?new Model(o,ModuleFactory.get(t.moduleName)):(t.update(r,o),t.defineProp(e,r))});else if(nodom.isArray(e)){let r=["push","unshift","splice","pop","shift","reverse","sort"],o=ModuleFactory.get(t.moduleName);r.forEach(function(r){e[r]=function(){let n=[];switch(r){case"push":case"unshift":for(let e=0;e<arguments.length;e++)n.push(arguments[e]);break;case"splice":if(arguments.length>2)for(let e=2;e<arguments.length;e++)n.push(arguments[e]);break;case"pop":o.deleteData(e[e.length-1].$modelId);break;case"shift":o.deleteData(e[0].$modelId)}t.update(e),Array.prototype[r].apply(e,arguments),n.forEach(e=>{(nodom.isObject(e)||nodom.isArray(e))&&new Model(e,ModuleFactory.get(t.moduleName))})}}),e.forEach(e=>{(nodom.isObject(e)||nodom.isArray(e))&&new Model(e,ModuleFactory.get(t.moduleName))})}}defineProp(e,t){const r=this;Object.defineProperty(e,t,{set:function(o){r.fields[t]!==o&&(r.update(t,o),e[t]=o)},get:function(){if(void 0!==r.fields[t])return r.fields[t]}})}query(e){let t=this.data,r=e.split(".");for(let e=0;e<r.length&&null!==t&&"object"==typeof t;e++){if(void 0===t)return;if("]"===r[e].charAt(r[e].length-1)){let o=r[e].split("[");t=t[o[0]],o.shift(),o.forEach(e=>{let r=e.substr(0,e.length-1);t=t[parseInt(r)]})}else t=t[r[e]]}return t}}class Filter{constructor(e){nodom.isString(e)&&(e=FilterManager.explain(e)),e&&(this.type=e[0],this.params=e.slice(1))}exec(e,t){let r=[t,this.type,e].concat(this.params);return nodom.apply(FilterManager.exec,t,r)}}class DirectiveManager{static addType(e,t){if(this.directiveTypes.has(e))throw Error.handle("exist1",nodom.words.directiveType,e);if(!nodom.isObject(t))throw Error.handle("invoke","DirectiveManager.addType",1,"Function");t.prio=t.prio||10,this.directiveTypes.set(e,t)}static removeType(e){if(-1!==this.cantEditTypes.indexOf(e))throw Error.handle("notupd",nodom.words.system+nodom.words.directiveType,e);if(!this.directiveTypes.has(e))throw Error.handle("notexist1",nodom.words.directiveType,e);this.directiveTypes.delete(e)}static getType(e){return this.directiveTypes.get(e)}static hasType(e){return this.directiveTypes.has(e)}static init(e,t,r,o){let n=this.directiveTypes.get(e.type);if(void 0===n)throw Error.handle("notexist1",nodom.words.directiveType,name);return n.init(e,t,r,o)}static exec(e,t,r,o){let n=arguments;if(n[0]=e,!this.directiveTypes.has(e.type))throw Error.handle("notexist1",nodom.words.directiveType,type);return nodom.apply(this.directiveTypes.get(e.type).handle,null,n)}}DirectiveManager.directiveTypes=new Map,DirectiveManager.cantEditTypes=["model","repeat","if","else","show","class","field"];class Directive{constructor(e,t,r,o){const n=this;n.type=e,nodom.isString(t)&&(n.value=t.trim()),void 0!==e&&nodom.apply(DirectiveManager.init,DirectiveManager,[n,r,o]),n.id=nodom.genId()}exec(e){let t=[this.module,this.type,e].concat(this.params);return nodom.apply(DirectiveManager.exec,DirectiveManager,t)}}class Module{constructor(e){const t=this;t.id=nodom.genId(),t.firstRender=!0,t.rendered=!1,t.virtualDom=void 0,t.renderTree=void 0,t.parentName=void 0,t.children=void 0,t.selector=void 0,t.isMain=!1,t.firstRenderOps=[],t.beforeFirstRenderOps=[],t.containerParam=void 0,t.state=0,e.name?t.name=e.name:t.name="Module"+nodom.genId(),ModuleFactory.add(t.name,t),t.methodFactory=new MethodFactory(t),t.modelFactory=new ModelFactory(t),t.expressionFactory=new ExpressionFactory(t),t.directiveFactory=new DirectiveFactory(t),t.renderDoms=[],e&&(t.initConfig=e,nodom.isString(e.el)?t.containerParam={module:e.parentName,selector:e.el}:nodom.isEl(e.el)&&(t.container=e.el),nodom.isObject(e.methods)&&nodom.getOwnProps(e.methods).forEach(r=>{t.methodFactory.add(r,e.methods[r])}),t.templateStr="",t.hasContainer()&&(t.templateStr=t.container.innerHTML.trim(),t.container.innerHTML=""),e.root&&(t.isMain=!0,ModuleFactory.setMain(t),t.active()),e.delayInit&&!t.isMain||t.init())}init(){const e=this;if(0!==e.state||e.initing)return e.initLinker;e.initing=!0;let t=e.initConfig,r=[],o=[],n=nodom.config.appPath||"";return nodom.isArray(t.requires)&&t.requires.length>0&&t.requires.forEach(e=>{let t,n="";if(nodom.isObject(e)?(t=e.type||"js",n+=e.path):(t="js",n+=e),"css"===t){let e=nodom.get("link[href='"+n+"']");if(null!==cs)return;return(e=nodom.newEl("link")).type="text/css",e.rel="stylesheet",e.href=path,void head.appendChild(e)}if("js"===t){if(null!==nodom.get("script[dsrc='"+n+"']"))return}r.push(t),o.push(n)}),t.template?e.templateStr+=t.template.trim():t.templateUrl?(r.push("template"),o.push(n+t.templateUrl)):t.compiledTemplate&&(r.push("compiled"),o.push(n+t.compiledTemplate)),nodom.isEmpty(e.templateStr)||(e.virtualDom=Compiler.compile(e,e.templateStr),delete e.templateStr),t.data?e.model=new Model(t.data,e):t.dataUrl&&(r.push("data"),o.push(t.dataUrl)),r.length>0?e.initLinker=new Linker("getfiles",o).then(t=>{let n=document.querySelector("head");t.forEach((t,i)=>{switch(r[i]){case"js":let s=nodom.newEl("script");s.innerHTML=t,n.appendChild(s),s.setAttribute("dsrc",o[i]),s.innerHTML="",n.removeChild(s);break;case"template":e.virtualDom=Compiler.compile(e,t.trim());break;case"compiled":let a=Serializer.deserialize(t,e);e.virtualDom=a[0],e.expressionFactory=a[1];break;case"data":e.model=new Model(JSON.parse(t),e)}}),i(e),delete e.initing}):(e.initLinker=Promise.resolve(),i(e),delete e.initing),nodom.isArray(e.initConfig.modules)&&e.initConfig.modules.forEach(t=>{e.addChild(t)}),delete e.initConfig,e.initLinker;function i(e){e.isMain?(e.state=3,Renderer.add(e)):e.parentName?e.state=ModuleFactory.get(e.parentName).state:e.state=1}}render(){const e=this;if(3!==e.state||!e.virtualDom||!e.hasContainer())return!1;let t=e.virtualDom.clone(e);if(e.firstRender)e.doModuleEvent("onBeforeFirstRender"),e.beforeFirstRenderOps.forEach(t=>{nodom.apply(t,e,[])}),e.beforeFirstRenderOps=[],e.renderTree=t,e.model&&(t.modelId=e.model.id),t.render(e,null),t.children&&t.children.forEach(t=>{t.renderToHtml(e,{type:"fresh"})}),delete e.firstRender,setTimeout(()=>{e.doModuleEvent("onFirstRender"),e.firstRenderOps.forEach(t=>{nodom.apply(t,e,[])}),e.firstRenderOps=[]},0);else{if(e.doModuleEvent("onBeforeRender"),e.model){t.modelId=e.model.id;let r=e.renderTree;e.renderTree=t,t.render(e,null),t.compare(r,e.renderDoms);for(let t=e.renderDoms.length-1;t>=0;t--){let r=e.renderDoms[t];"del"===r.type&&(r.node.removeFromHtml(e),e.renderDoms.splice(t,1))}e.renderDoms.forEach(t=>{t.node.renderToHtml(e,t)})}setTimeout(()=>{e.doModuleEvent("onRender")},0)}return e.renderDoms=[],nodom.isArray(e.children)&&e.children.forEach(e=>{e.render()}),!0}hasContainer(){const e=this;if(e.container)return!0;if(void 0!==e.containerParam){let t;if(void 0===e.containerParam.module)t=document;else{let r=ModuleFactory.get(e.containerParam.module);r&&(t=r.container)}if(t)return e.container=t.querySelector(e.containerParam.selector),null!==e.container}return!1}dataChange(e){Renderer.add(this)}addChild(e){const t=this;e.parentName=t.name;let r=new Module(e);return void 0===t.children&&(t.children=[]),t.children.push(r),r}send(e,t){MessageFactory.add(this.name,e,t)}broadcast(e){const t=this;if(t.parentName){let r=ModuleFactory.get(t.parentName);r&&r.children&&(t.send(r.name,e),r.children.forEach(r=>{r!==t&&t.send(r.name,e)}))}void 0!==t.children&&t.children.forEach(r=>{t.send(r.name,e)})}receive(e,t){this.doModuleEvent("onReceive",[e,t])}active(e){const t=this;if(3===t.state)return;return 0===t.state?t.init().then(()=>{t.state=3,nodom.isFunction(e)&&e(t.model),Renderer.add(t)}):(t.state=3,e&&e(t.model),Renderer.add(t)),nodom.isArray(t.children)&&t.children.forEach(t=>{t.active(e)}),Promise.resolve()}unactive(){const e=this;e.isRoot||2===e.state||(e.state=2,e.firstRender=!0,delete e.container,nodom.isArray(e.children)&&e.children.forEach(e=>{e.unactive()}))}dead(){4!==this.state&&(me.state=4,nodom.isArray(me.children)&&me.children.forEach(e=>{e.unactive()}))}destroy(){nodom.isArray(me.children)&&me.children.forEach(e=>{e.destroy()}),ModuleFactory.remove(me.name)}doModuleEvent(e,t){const r=this;let o=r.methodFactory.get(e);t||(t=[r.model]),nodom.isFunction(o)&&nodom.apply(o,r.model,t)}addFirstRenderOperation(e){let t=this;nodom.isFunction(e)&&-1===t.firstRenderOps.indexOf(e)&&t.firstRenderOps.push(e)}addBeforeFirstRenderOperation(e){let t=this;nodom.isFunction(e)&&-1===t.beforeFirstRenderOps.indexOf(e)&&t.beforeFirstRenderOps.push(e)}}class MethodFactory extends Factory{invoke(e,t){let r=this.get(e);if(!nodom.isFunction(r))throw new Exception(nodom.ErrorMsgs.notexist1,nodom.words.method,e);return nodom.apply(r,this.module.model,t)}}class Router{static addPath(e){const t=this;for(let r=0;r<t.waitList.length;r++){let o=t.waitList[r];if(o===e)return;if(0===o.indexOf(e)&&"/"===o.indexOf(e.length+1))return}t.waitList.push(e),t.load()}static load(){const e=this;if(e.loading||0===e.waitList.length)return;let t=e.waitList.shift();e.loading=!0,e.start(t)}static start(e){const t=this;let r=t.compare(t.currentPath,e),o=null===r[0]?ModuleFactory.getMain():ModuleFactory.get(r[0].module);for(let e=r[1].length-1;e>=0;e--){const o=r[1][e];if(!o.module)continue;let n=ModuleFactory.get(o.module);nodom.isFunction(t.onDefaultLeave)&&t.onDefaultLeave(n.model),nodom.isFunction(o.onLeave)&&o.onLeave(n.model),n.unactive()}let n=[],i=[],s="";if(0===r[2].length)null!==r[0]&&(a(r[0]),r[0].useParentPath||(s=r[0].fullPath)),r[0].setLinkActive(!0);else for(let e=0;e<r[2].length;e++){let l=r[2][e];if(l&&l.module){if(l.useParentPath||(s=l.fullPath),!o.routerKey)throw Error.handle("notexist",nodom.words.routeView);Router.moduleRouteMap[l.module]=l.id,i.push(l.module),n.push((e,r,n)=>{let i=ModuleFactory.get(n);i.addBeforeFirstRenderOperation(function(){nodom.empty(i.container)}),i.containerParam={module:o.name,selector:"[key='"+o.routerKey+"']"},i.active(r=>{let n=Router.routes.get(Router.moduleRouteMap[i.name]);n&&(n.setLinkActive(!0),delete Router.moduleRouteMap[i.name],a(n),nodom.isFunction(t.onDefaultEnter)&&t.onDefaultEnter(r),nodom.isFunction(n.onEnter)&&n.onEnter(r),o=i,e&&e())})})}}if(2!==t.startStyle&&""!==s&&(t.showPath&&0===s.indexOf(t.showPath)?history.replaceState(e,"",nodom.config.routerPrePath+s):history.pushState(e,"",nodom.config.routerPrePath+s),t.showPath=s),0===n.length)return Router.loading=!1,void(Router.startStyle=0);function a(e){if(!e)return;let t=ModuleFactory.get(e.module),r=t.model,o={path:e.path};nodom.isEmpty(e.data)||(o.data=e.data),r?r.data.$route=o:t.model=new Model({$route:o},t),Renderer.add(t)}t.currentPath=e,new Linker("dolist",n,i).then(()=>{Router.loading=!1,t.load(),Router.startStyle=0})}static redirect(e){this.addPath(e)}static addRoute(e,t){if(!1===RouterTree.add(e,t))throw Error.handle("exist1",nodom.words.route,e.path);this.routes.set(e.id,e)}static getRoute(e,t){if(!e)return null;let r=RouterTree.get(e);return null===r||0===r.length?null:t?r[r.length-1]:r}static compare(e,t){const r=this;let o=null,n=null;e&&(o=r.getRoute(e)),t&&(n=r.getRoute(t));let i=0;null!==o&&(i=o.length),null!==n?n.length<i&&(i=n.length):i=0;let s=[],a=[],l=0;for(l=0;l<i&&o[l].id===n[l].id;l++)if(JSON.stringify(o[l].data)!==JSON.stringify(n[l].data)){l++;break}if(null!==o)for(let e=l;e<o.length;e++)s.push(o[e]);if(null!==n)for(let e=l;e<n.length;e++)a.push(n[e]);let d=null,c=null;if(null!==o&&l>0)for(let e=l-1;e>=0&(null===d||null===c);e--)void 0!==o[e].module&&(null===d?d=o[e]:null===c&&(c=o[e]));return[d,s,a,c]}static changeActive(e,t){e&&t&&""!==t&&e.routerActiveViews&&e.routerActiveViews.forEach(r=>{let o=e.renderTree.query(r);if(o)if(o.exprProps.hasOwnProperty("active")){let r=e.modelFactory.get(o.modelId);if(!r)return;let n=e.expressionFactory.get(o.exprProps.active[0]);if(!n)return;let i=n.fields[0];0===t.indexOf(o.props.path)?r.data[i]=!0:r.data[i]=!1}else o.props.hasOwnProperty("active")&&(0===t.indexOf(o.props.path)?o.props.active=!0:o.props.active=!1)})}}Router.loading=!1,Router.routes=new Map,Router.currentPath="",Router.showPath="",Router.waitList=[],Router.currentIndex=0,Router.onDefaultEnter=void 0,Router.onDefaultLeave=void 0,Router.moduleRouteMap={},Router.startStyle=0;class Route{constructor(e){const t=this;t.params=[],t.data={},t.children=[],t.onEnter=e.onEnter,t.onLeave=e.onLeave,t.useParentPath=e.useParentPath,t.path=e.path,t.module=e.module instanceof Module?e.module.name:e.module,""!==e.path&&(t.id=nodom.genId(),e.notAdd||Router.addRoute(t,e.parent),nodom.isArray(e.routes)&&e.routes.forEach(e=>{e.parent=t,new Route(e)}))}setLinkActive(e){let t=this.fullPath,r=ModuleFactory.get(this.module);if(r&&r.containerParam){let e=ModuleFactory.get(r.containerParam.module);e&&Router.changeActive(e,t)}e&&this.parent&&this.parent.setLinkActive(!0)}}class RouterTree{static add(e,t){const r=this;r.root||(r.root=new Route({path:"",notAdd:!0}));let o=e.path.split("/"),n=t||r.root,i=[],s=-1,a="";for(let t=0;t<o.length;t++){let r=o[t].trim();if(""!==r){if(r.startsWith(":"))0===i.length&&(s=t),i.push(r.substr(1));else{s=-1,i=[],e.path=r;let t=0;for(;t<n.children.length;t++){let e=n.children[t];if(e.path===r){n=e;break}}t===n.children.length&&(""!==a&&(n.children.push(new Route({path:a,notAdd:!0})),n=n.children[n.children.length-1]),a=r)}e.params=-1===s?[]:i}else o.splice(t--,1)}return void 0!==n&&n!==e&&(e.path=a,n.children.push(e)),!0}static get(e){const t=this;if(!t.root)throw Error.handle("notexist",nodom.words.root);let r=e.split("/"),o=t.root,n=0,i=[],s="",a=t.root;for(let e=0;e<r.length;e++){let l=r[e].trim();if(""===l){r.splice(e--,1);continue}let d=!1;for(let e=0;e<o.children.length;e++)if(o.children[e].path===l){a!==t.root&&(a.fullPath=s,a.data=o.data,i.push(a)),(o=o.children[e]).data={},a=o,d=!0;break}s+="/"+l,d||n<o.params.length&&(o.data[o.params[n++]]=l)}return o!==t.root&&(o.fullPath=s,i.push(o)),i}}window.addEventListener("popstate",function(e){const t=history.state;t&&(Router.startStyle=2,Router.addPath(t))}),DirectiveManager.addType("route",{init:(e,t,r)=>{let o=e.value;if(nodom.isEmpty(o))return;if("A"===t.tagName&&(t.props.href="javascript:void(0)"),o&&"{{"===o.substr(0,2)&&"}}"===o.substr(o.length-2,2)){let n=new Expression(o.substring(2,o.length-2),r);t.exprProps.path=n,e.value=n}else t.props.path=o;let n="$nodomGenMethod"+nodom.genId();r.methodFactory.add(n,(e,t,r,o)=>{let n=o.props.path;n&&Router.addPath(n)}),t.events.click=new Event("click",n)},handle:(e,t,r,o)=>{if(r.routerActiveViews||(r.routerActiveViews=[]),-1===r.routerActiveViews.indexOf(t.key)&&(r.routerActiveViews.push(t.key),t.props.hasOwnProperty("active"))){if(null===Router.getRoute(t.props.path,!0))return}let n=t.props.path;n!==Router.currentPath&&(!t.props.active||"false"===t.props.active||Router.currentPath&&0!==n.indexOf(Router.currentPath)||Router.addPath(n))}}),DirectiveManager.addType("router",{init:(e,t,r)=>{r.routerKey=t.key},handle:(e,t,r,o)=>{}});class Serializer{static serialize(e){let t=["virtualDom","expressionFactory"],r="[";return t.forEach((o,n)=>{!function e(t){if("object"!=typeof t)return;let r=Class.getClassName(t);r&&Class.getClass(r)&&(t.className=r);nodom.getOwnProps(t).forEach(r=>{nodom.isArray(t[r])?0===t[r].length?delete t[r]:t[r].forEach(t=>{e(t)}):"object"==typeof t[r]&&(nodom.isEmpty(t[r])?delete t[r]:e(t[r]))})}(e[o]);let i=JSON.stringify(e[o]);r+=i,n<t.length-1?r+=",":r+="]"}),r}static deserialize(e,t){let r,o=[];return JSON.parse(e).forEach(e=>{o.push(function e(o){if(!nodom.isObject(o))return o;o.moduleName&&(o.moduleName=t.name);let n;if(o.hasOwnProperty("className")){const e=o.className;let i=[];switch(e){case"Directive":i=[o.type,o.value,r,t];break;case"Event":i=[o.name]}n=Class.newInstance(e,i),"Element"===e&&(r=n)}else n={};let i=[];let s=[];nodom.getOwnProps(o).forEach(e=>{nodom.isObject(o[e])?i.push(e):nodom.isArray(o[e])?s.push(e):"className"!==e&&(n[e]=o[e])});i.forEach(t=>{n[t]=e(o[t])});s.forEach(t=>{n[t]=[],o[t].forEach(r=>{n[t].push(e(r))})});return n}(e))}),o}}class FilterManager{static addType(e,t){if(!/^[a-zA-Z]+$/.test(e))throw Error.handle("namedinvalid",nodom.words.filterType,e);if(this.filterTypes.has(e))throw Error.handle("exist1",nodom.words.filterType,e);if(!nodom.isFunction(t))throw Error.handle("invoke","FilterManager.addType",1,"Function");this.filterTypes.set(e,t)}static removeType(e){if(-1!==this.cantEditTypes.indexOf(e))throw Error.handle("notupd",nodom.words.system+nodom.words.filterType,e);if(!this.filterTypes.has(e))throw Error.handle("notexist1",nodom.words.filterType,e);this.filterTypes.delete(e)}static hasType(e){return this.filterTypes.has(e)}static exec(e,t,r){let o=new Array;for(let e=2;e<arguments.length;e++)o.push(arguments[e]);if(!FilterManager.filterTypes.has(t))throw Error.handle("notexist1",nodom.words.filterType,t);return nodom.apply(FilterManager.filterTypes.get(t),e,o)}static explain(src){let startStr,startObj=!1,strings="\"'`",splitCh=":",retArr=new Array,tmp="";for(let e=0;e<src.length;e++){let t=src[e];-1!==strings.indexOf(t)?startStr=t===startStr?void 0:t:void 0===startStr&&("}"===t&&startObj?startObj=!1:"{"===t&&(startObj=!0)),t!==splitCh||void 0!==startStr||startObj||""===tmp?tmp+=t:(retArr.push(handleObj(tmp)),tmp="")}return""!==tmp&&retArr.push(handleObj(tmp)),retArr;function handleObj(s){return s=s.trim(),"{"===s.charAt(0)&&(s=eval("("+s+")")),s}}}FilterManager.filterTypes=new Map,FilterManager.cantEditTypes=["date","currency","number","tolowercase","touppercase","orderBy","filter"],DirectiveManager.addType("model",{prio:1,init:(e,t,r)=>{let o=e.value;if(nodom.isString(o)){let t=new Array;o.split(".").forEach(e=>{let r=-1,o=-1;if(-1!==(r=e.indexOf("["))&&-1!==(o=e.indexOf("]"))){let n=e.substr(0,r),i=e.substring(r+1,o);t.push(n+","+i)}else t.push(e)}),e.value=t}},handle:(e,t,r,o)=>{let n=r.modelFactory.get(t.modelId);if(!n||!n.data)return;let i=n.data;return e.value.forEach(e=>{if(i)if(-1!==e.indexOf(",")){let t=e.split(",");i=i[t[0]][parseInt(t[1])]}else i=i[e]}),i&&(t.modelId=i.$modelId),!0}}),DirectiveManager.addType("repeat",{prio:2,init:(e,t,r)=>{let o,n,i=e.value;if(!i)throw Error.handle("paramException","x-repeat");-1!==(o=i.indexOf("|"))?(n=i.substr(0,o).trim(),e.filter=new Filter(i.substr(o+1))):n=i,t.hasDirective("mocel")||t.directives.push(new Directive("model",n,t,r)),e.value=n},handle:(e,t,r,o)=>{let n=r.modelFactory.get(t.modelId).data;if(void 0!==e.filter&&(n=e.filter.exec(n,r)),void 0===n||0===n.length)return t.dontRender=!0,!0;let i=[],s=t.key;t.removeDirectives(["model","repeat"]);for(let e=0;e<n.length;e++){let o=t.clone(r);o.modelId=n[e].$modelId,a(o,s,o.modelId),n[e].$index=e,i.push(o)}if(i.length>0)for(let e=0,r=o.children.length;e<r;e++)if(o.children[e]===t){i=[e+1,0].concat(i),Array.prototype.splice.apply(o.children,i);break}return t.dontRender=!0,!1;function a(e,t,r){e.key=t+"_"+r,e.children.forEach(e=>{a(e,e.key,r)})}}}),DirectiveManager.addType("if",{init:(e,t,r)=>{let o=e.value;if(!o)throw Error.handle("paramException","x-repeat");let n=new Expression(o,r);e.value=n},handle:(e,t,r,o)=>{let n=r.modelFactory.get(t.modelId),i=e.value.val(n),s=-1,a=-1;for(let e=0;e<o.children.length&&(o.children[e]===t?s=e:-1===a&&o.children[e].hasDirective("else")&&(a=e),e!==s&&-1!==s&&-1===a&&void 0!==o.children[e].tagName&&(a=-2),-1===s||-1===a);e++);if(i&&"false"!==i){a>0&&(o.children[a].dontRender=!0)}else a>0&&(t.dontRender=!0);return!0}}),DirectiveManager.addType("else",{name:"else",init:(e,t,r)=>{},handle:(e,t,r,o)=>{}}),DirectiveManager.addType("show",{init:(e,t,r)=>{let o=e.value;if(!o)throw Error.handle("paramException","x-show");let n=new Expression(o,r);e.value=n},handle:(e,t,r,o)=>{let n=r.modelFactory.get(t.modelId),i=e.value.val(n),s=t.style?t.style.split(";"):[],a=!1,l=i&&"false"!==i?"block":"none";for(let e=0;e<s.length;e++)if(-1===s[e].indexOf("display:")){a=!0,s[e]="display:"+l;break}a||s.push("display:"+l),t.props.style=s.join(";")}}),DirectiveManager.addType("class",{init:(directive,dom,module)=>{let obj=eval("("+directive.value+")");if(!nodom.isObject(obj))return;let robj={};nodom.getOwnProps(obj).forEach(function(e){nodom.isString(obj[e])?robj[e]=new Expression(obj[e],module):robj[e]=obj[e]}),directive.value=robj},handle:(e,t,r,o)=>{let n=e.value,i=[],s=t.props.class,a=r.modelFactory.get(t.modelId);nodom.isString(s)&&!nodom.isEmpty(s)&&(i=s.trim().split(/\s+/)),nodom.getOwnProps(n).forEach(function(e){let t=n[e];t instanceof Expression&&(t=t.val(a));let r=i.indexOf(e);t&&"false"!==t?-1===r&&i.push(e):-1!==r&&i.splice(r,1)}),t.props.class=i.join(" ")}}),DirectiveManager.addType("field",{init:(e,t,r)=>{let o=e.value,n=t.tagName.toLowerCase(),i=t.props.type,s="input";"input"!==n||"checkbox"!==i&&"radio"!==i||(s="change"),t.props.name=o;let a="$nodomGenMethod"+nodom.genId();r.methodFactory.add(a,function(e,t,r,o){let n=o.props.type,i=(t.modelFactory.get(o.modelId),o.getDirective("field").value),s=r.value;"checkbox"===n?s=o.props["yes-value"]==s?o.props["no-value"]:o.props["yes-value"]:"radio"===n&&(r.checked||(s=void 0)),this.data[i]=s,"radio"!==n&&(o.props.value=s,r.value=s)}),t.events[s]=new Event(s,a),setTimeout(()=>{t.exprProps.hasOwnProperty("value")||t.props.hasOwnProperty("value")||(t.exprProps.value=new Expression(o,r))},0)},handle:(e,t,r,o)=>{const n=t.props.type,i=t.tagName.toLowerCase(),s=r.modelFactory.get(t.modelId).data[e.value];let a=t.props.value;if("radio"===n)s==a?t.props.checked="checked":delete t.props.checked;else if("checkbox"===n){let e=t.props["yes-value"];s==e?(t.props.checked="checked",t.props.value=e):(delete t.props.checked,t.props.value=t.props["no-value"])}else"select"===i&&(t.props.value=s,setTimeout(function(){r.container.querySelector("[key='"+t.key+"']").value=s},0))}}),DirectiveManager.addType("validity",{init:(e,t,r)=>{let o,n,i,s=e.value;-1!==(o=s.indexOf("|"))?(n=s.substr(0,o),i=s.substr(o+1)):n=s,e.value=n,e.params={enabled:!1},i&&(e.params.method=i),setTimeout(()=>{if(0===t.children.length){let e=new Element;e.textContent="   ",t.children.push(e)}else t.children.forEach(e=>{if(0===e.children.length){let t=new Element;t.textContent="   ",e.children.push(t)}})},0),r.addFirstRenderOperation(function(){const t=this,o=r.container.querySelector("[name='"+e.value+"']");o&&(o.addEventListener("focus",function(e){o.canBeValid=!0}),o.addEventListener("blur",function(e){Renderer.add(t)}))})},handle:(e,t,r,o)=>{const n=r.container.querySelector("[name='"+e.value+"']");if(!n||!n.canBeValid)return void(t.dontRender=!0);let i=[];t.children.forEach(e=>{void 0!==e.tagName&&e.props.hasOwnProperty("rel")&&i.push(e)});let s=[];if(e.params.method){const t=r.methodFactory.get(e.params.method);if(nodom.isFunction(t)){t.call(r.model,n.value)||s.push("custom")}}let a=n.validity;if(!a.valid)for(var l in a)!0===a[l]&&s.push(l);if(s.length>0){let e=function(e){for(var t=0;t<e.length;t++)switch(e[t]){case"valueMissing":return"required";case"typeMismatch":return"type";case"tooLong":return"maxLength";case"tooShort":return"minLength";case"rangeUnderflow":return"min";case"rangeOverflow":return"max";case"patternMismatch":return"pattern";default:return e[t]}}(s);if(0===i.length)d(t,e,n);else for(let t=0;t<i.length;t++){i[t].props.rel===e?d(i[t],e,n):i[t].dontRender=!0}}else t.dontRender=!0;function d(e,t,r){let o=e.children[0].textContent.trim();""===o&&(o=nodom.compileStr(nodom.FormMsgs[t],r.getAttribute(t))),e.children[0].textContent=o}}}),FilterManager.addType("date",(e,t)=>nodom.isEmpty(e)?"":(t=t.substr(1,t.length-2),nodom.formatDate(e,t))),FilterManager.addType("currency",(e,t)=>isNaN(e)?"":(t=t||"¥","string"==typeof e&&(e=parseFloat(e)),t+(100*e+.5|0)/100)),FilterManager.addType("number",(e,t)=>{let r=t||0;if(isNaN(e)||r<0)return"";"string"==typeof e&&(e=parseFloat(e));let o=1;for(let e=0;e<r;e++)o*=10;return(e*o+.5|0)/o}),FilterManager.addType("tolowercase",e=>{if(nodom.isEmpty(e))return"";if(!nodom.isString(e)||nodom.isEmpty(e))throw Error.handle("invoke1",nodom.words.filter+" tolowercase",0,"string");return e.toLowerCase()}),FilterManager.addType("touppercase",e=>{if(nodom.isEmpty(e))return"";if(!nodom.isString(e)||nodom.isEmpty(e))throw Error.handle("invoke1",nodom.words.filter+" touppercase",0,"string");return e.toUpperCase()}),FilterManager.addType("orderby",function(){let e=arguments,t=e[0],r=e[1],o=e[2]||"asc";if(!nodom.isArray(t))throw Error.handle("invoke1",nodom.words.filter+" orderby",0,"array");let n=t.concat([]);return r&&nodom.isObject(t[0])?"asc"===o?n.sort((e,t)=>e[r]>=t[r]?1:-1):n.sort((e,t)=>t[r]<=e[r]?1:-1):"asc"===o?n.sort((e,t)=>e>=t?1:-1):n.sort((e,t)=>t<=e?1:-1),n}),FilterManager.addType("select",function(){if(!nodom.isArray(arguments[0]))throw Error.handle("invoke1",nodom.words.filter+" filter",0,"array");let e=new Array;for(let t=0;t<arguments.length;t++)e.push(arguments[t]);let t,r={odd:function(){let e=arguments[0],t=[];for(let r=0;r<e.length;r++)r%2==1&&t.push(e[r]);return t},even:function(){let e=arguments[0],t=[];for(let r=0;r<e.length;r++)r%2==0&&t.push(e[r]);return t},range:function(){let e=arguments,t=e[0],r=e[1],o=e[2];if(isNaN(r))throw Error.handle("paramException",nodom.words.filter,"filter range");if(nodom.isNumber(r)||(r=parseInt(r)),isNaN(o))throw Error.handle("paramException",nodom.words.filter,"filter range");if(nodom.isNumber(o)||(o=parseInt(o)),r>o)throw Error.handle("paramException",nodom.words.filter,"filter range");return t.slice(r,o+1)},index:function(){let e=arguments,t=e[0];if(!nodom.isArray(e[0]))throw Error.handle("paramException",nodom.words.filter,"filter index");let r=[];if(t.length>0)for(let o=1;o<e.length;o++){if(isNaN(e[o]))continue;let n=parseInt(e[o]);n<t.length&&r.push(t[n])}return r},func:function(e,t){if(!nodom.isArray(e)||nodom.isEmpty(t))throw Error.handle("paramException",nodom.words.filter,"filter func");let r=this.methodFactory.get(t);return nodom.isFunction(r)?r(e):e},value:function(e,t){if(!nodom.isArray(e)||nodom.isEmpty(t))throw Error.handle("paramException",nodom.words.filter,"filter value");if(nodom.isObject(t)){let r=nodom.getOwnProps(t);return e.filter(function(e){for(let o=0;o<r.length;o++){let n=e[r[o]],i=t[r[o]];if(void 0===n||n!==i&&"string"==typeof n&&-1===n.indexOf(i))return!1}return!0})}return e.filter(function(e){let r=nodom.getOwnProps(e);for(let o=0;o<r.length;o++){let n=e[r[o]];if(nodom.isString(n)&&-1!==n.indexOf(t))return e}})}};if(nodom.isString(e[1])?(t=e[1].trim(),r.hasOwnProperty(t)?e.splice(1,1):t="value"):t="value",("range"===t||"index"===t||"func"===t)&&e.length<2)throw Error.handle("paramException",nodom.words.filter);return nodom.apply(r[t],this,e)}),FilterManager.addType("html",e=>{if(nodom.isEmpty(e))return"";let t=nodom.newEl("div");t.innerHTML=e;let r=document.createDocumentFragment();for(let e=0;e<t.childNodes.length;e++)r.appendChild(t.childNodes[e]);return r}),Class.add("Directive",Directive),Class.add("Filter",Filter),Class.add("Expression",Expression),Class.add("Element",Element),Class.add("Module",Module),Class.add("Model",Model),Class.add("Event",Event),Class.add("Route",Route),Class.add("DirectiveFactory",DirectiveFactory),Class.add("ExpressionFactory",ExpressionFactory),Class.add("MethodFactory",MethodFactory),Class.add("MessageFactory",MessageFactory),Class.add("ModelFactory",ModelFactory),Class.add("ModuleFactory",ModuleFactory),nodom.createModule=function(e){if(!nodom.isArray(e))return new Module(e);e.forEach(e=>{new Module(e)})},nodom.createRoute=function(e){if(!nodom.isArray(e))return new Route(e);e.forEach(e=>{new Route(e)})};